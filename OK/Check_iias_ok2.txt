procedure Check_IIAS_OK is
  cnt number;
  cnt_uchzav number;
  cnt_obraz number;
begin
  For Rec In (select TABNO,PASS_NUM from OK_PERSONAL where PASS_SERIYA is null and STATUS_CODE IN (2,5))
  Loop
     err('Ошибка 05921 для отчетности ИИАС, Отдел Кадров: не указана серия паспорта Таб.Номер='||rec.TABNO);
  End Loop;

  For Rec In (select TABNO,COD_STR_BIRTH from OK_PERSONAL
    where (COD_STR_BIRTH is null or COD_STR_BIRTH not in (select code_str from s_str))
    and STATUS_CODE in (2,5) )
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Страны и территории> Таб.Номер='||rec.TABNO||' Страна рожд.='||rec.COD_STR_BIRTH);
  End Loop;

  For Rec In (select TABNO,COD_STR_SITIZENT from OK_PERSONAL
     where (COD_STR_SITIZENT is null or COD_STR_SITIZENT not in (select code_str from s_str))
     and STATUS_CODE in (2,5) )
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Страны и территории> Таб.Номер='||rec.TABNO||' Cтрана гражд.='||rec.COD_STR_SITIZENT);
  End Loop;

  For Rec In (select ok_personal.TABNO,OK_PERSONAL.COD_STR_LIVE from OK_PERSONAL
    where (OK_PERSONAL.COD_STR_LIVE is null or OK_PERSONAL.COD_STR_LIVE not in (select code_str from s_str))
    and OK_PERSONAL.STATUS_CODE in (2,5) )
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Страны и территории> Таб.Номер='||rec.TABNO||' Страна проживания='||rec.COD_STR_LIVE);
  End Loop;

  For Rec In (select ok_personal.TABNO,SS_OK_NCI.OK_ID from OK_PERSONAL,OK_DEGREE,(select * from SS_OK_NCI where SS_OK_NCI.NCI_ID=75) SS_OK_NCI
              where OK_PERSONAL.PERSONAL_CODE=OK_DEGREE.PERSONAL_CODE and OK_DEGREE.DEGREE_CODE=SS_OK_NCI.Ok_Id(+) and OK_PERSONAL.STATUS_CODE in (2,5) and SS_OK_NCI.Ok_Id is null)
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Ученые степени> Таб.Номер='||rec.TABNO||' Ученые степени='||rec.OK_ID);
  End Loop;

  For Rec In (select ok_personal.TABNO,SS_OK_NCI.OK_ID from OK_PERSONAL,OK_ACADEMIC,(select * from SS_OK_NCI where SS_OK_NCI.NCI_ID=76) SS_OK_NCI
              where OK_PERSONAL.PERSONAL_CODE=OK_ACADEMIC.PERSONAL_CODE and OK_ACADEMIC.ACADEMIC_CODE=SS_OK_NCI.Ok_Id(+) and OK_PERSONAL.STATUS_CODE in (2,5) and SS_OK_NCI.Ok_Id is null)
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Ученые звания> Таб.Номер='||rec.TABNO||' Ученые звание='||rec.OK_ID);
  End Loop;

  For Rec In (select ok_personal.TABNO,region_id from OK_PERSONAL
     where (OK_PERSONAL.REGION_ID is null or OK_PERSONAL.REGION_ID not in (select region_id from s_region))
     and OK_PERSONAL.STATUS_CODE in (2,5) and OK_PERSONAL.cod_str_birth = '860' )
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Области Республики Узбекистан> Таб.Номер='||rec.TABNO||' Место рожд.обл.='||rec.region_id);
  End Loop;

  For Rec In (select ok_personal.TABNO,COD_OBL_LIVE from OK_PERSONAL
     where (OK_PERSONAL.COD_OBL_LIVE is null or OK_PERSONAL.COD_OBL_LIVE not in (select region_id from s_region))
     and OK_PERSONAL.STATUS_CODE in (2,5) and OK_PERSONAL.cod_str_live = '860' )
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Области Республики Узбекистан> Таб.Номер='||rec.TABNO||' Область проживания='||rec.COD_OBL_LIVE);
  End Loop;

  For Rec In (select ok_personal.TABNO,distr from OK_PERSONAL
     where (OK_PERSONAL.distr is null or OK_PERSONAL.distr not in (select distr from s_distr))
     and OK_PERSONAL.STATUS_CODE in (2,5) and OK_PERSONAL.cod_str_birth = '860' )
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <районы Республики Узбекистан> Таб.Номер='||rec.TABNO||' Место рожд.район.='||rec.distr);
  End Loop;

  For Rec In (select ok_personal.TABNO,COD_DISTR_LIVE from OK_PERSONAL
     where (OK_PERSONAL.COD_DISTR_LIVE is null or OK_PERSONAL.COD_DISTR_LIVE not in (select distr from s_distr))
     and OK_PERSONAL.STATUS_CODE in (2,5) and OK_PERSONAL.cod_str_live = '860' )
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <районы Республики Узбекистан> Таб.Номер='||rec.TABNO||' район проживания='||rec.COD_DISTR_LIVE);
  End Loop;

  For Rec In (select ok_personal.TABNO,OK_PERSONAL.EDUCATION_TITLE_CODE from OK_PERSONAL where nvl(OK_PERSONAL.EDUCATION_TITLE_CODE,0)=0 and OK_PERSONAL.STATUS_CODE IN (2, 5)
               union all
              select ok_personal.TABNO,OK_PERSONAL.EDUCATION_TITLE_CODE from OK_PERSONAL,(select * from SS_OK_NCI where SS_OK_NCI.NCI_ID=74) ok74 where OK_PERSONAL.EDUCATION_TITLE_CODE is not null
                 and OK_PERSONAL.STATUS_CODE IN (2, 5) and OK_PERSONAL.EDUCATION_TITLE_CODE  = ok74.OK_ID (+) and ok74.OK_ID is null)
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Не соответствие к справочнику <Наименование Образования> Таб.Номер='||rec.TABNO||' Образование='||rec.EDUCATION_TITLE_CODE);
  End Loop;

  For Rec In (select ok_personal.TABNO,OK_PERSONAL.Nps_Id from OK_PERSONAL where OK_PERSONAL.STATUS_CODE IN (2,5) and (OK_PERSONAL.Nps_Id is null or length(nvl(OK_PERSONAL.Nps_Id,'0'))<14))
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Ошибка в длине номере пенсионного счета Таб.Номер='||rec.TABNO||' Пенсионный счет='||rec.Nps_Id);
  End Loop;

  For Rec In (select ok_personal.TABNO,OK_PERSONAL.PASS_NUM from OK_PERSONAL where length(nvl(OK_PERSONAL.PASS_NUM,'0'))<>7 and OK_PERSONAL.STATUS_CODE IN (2,5))
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Ошибка в длине номера паспорта Таб.Номер='||rec.TABNO||' Номер паспорта='||rec.PASS_NUM);
  End Loop;

  For Rec In (select ok_personal.Nps_Id, count(*) cnt from OK_PERSONAL where OK_PERSONAL.STATUS_CODE IN (2,5) group by OK_PERSONAL.Nps_Id having count(*)>1)
  Loop
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Ошибка в уникальность пенсионного номера  Пенсионный счет='||rec.Nps_Id||' существует в кол-ве= '||Rec.cnt);
  End Loop;

  select count(*) Into cnt FROM OK_PERSONAL, (select * from SS_OK_NCI where NCI_ID=79) BOSS where OK_PERSONAL.STATUS_CODE IN (2, 5) and OK_PERSONAL.POST_CODE=BOSS.OK_ID ;
  if cnt = 0 then
     err('Ошибка для отчетности ИИАС, Отдел Кадров: Отсутствует информация о <Руководящем составе>');
  end if;

  for rec_ok in (select okp.BRANCH, okp.PERSONAL_CODE,  okp.STATUS_CODE, okp.gender_code,
     okp.FAMILY, okp.FIRST_NAME, okp.PATRONYMIC, okp.NATIONALITY_CODE,
     okp.REGION_ID, okp.DISTR, okp.TABNO, 
     okp.DEPARTMENT_CODE, okp.POST_CODE, okp.NPS_ID,
     okp.SPECIAL_CODE, okp.COD_DISTR_UVD, okp.COD_DISTR_PRIM, okp.COD_STR_BIRTH, okp.COD_OBL_PRIM,
     okp.COD_PLACE_BIRTH_PRIM, okp.COD_STR_LIVE,
     okp.COD_OBL_LIVE, okp.COD_OBL_LIVE_PRIM, okp.COD_DISTR_LIVE, okp.COD_DISTR_LIVE_PRIM,
     okp.HOME_ADDRESSFACT_REGION_ID, okp.HOME_ADDRESSFACT_DISTR,
     okp.HOME_ADDRESS_REGION_ID, okp.HOME_ADDRESS_DISTR,
     okp.birthday, okp.pass_date,okp.COD_STR_SITIZENT,okp.CHECK_KFS, okp.BANK_SPEC, okp.EDUCATION_TITLE_CODE
     from ok_personal okp, SS_OK_NCI son
  where okp.tabno=okp.tabno -- таб номера 1,2,3
   and okp.branch=okp.branch and okp.STATUS_CODE in (2,5)
                    and okp.post_code=son.ok_id and son.NCI_ID=79)
  loop
      select count(*) into cnt from ok_period where branch=rec_ok.branch and personal_code=rec_ok.personal_code
      and post_code=rec_ok.post_code;
      if (cnt<1)
      then
        err('Ошибка 241 для отчетности ИИАС,Отдел Кадров:Таб.Номер='||rec_ok.TABNO||' Отсутствуют Сведения о работе в должности');
      end if;

      if (rec_ok.FAMILY is null) or (rec_ok.FIRST_NAME is null)
      then
        err('Ошибка 05918 для отчетности ИИАС,Отдел Кадров:Таб.Номер='||rec_ok.TABNO||' Фамилия и Имя должны обязательно указаны');
      end if;

      if (rec_ok.birthday is null)
      then
        err('Ошибка 05919 для отчетности ИИАС,Отдел Кадров:Таб.Номер='||rec_ok.TABNO||' Дата рождения должна быть обязательно указана');
      else
         cnt := round(months_between(sysdate,rec_ok.birthday)/12);
        if (cnt<16)
        or (cnt>90)
        then
          err('Ошибка 05919 для отчетности ИИАС,Отдел Кадров:Таб.Номер='||rec_ok.TABNO||' Дата рождения не верна');
        end if;
      end if;

      if (rec_ok.PASS_DATE is null)
      then
        err('Ошибка 05923 для отчетности ИИАС,Отдел Кадров:Таб.Номер='||rec_ok.TABNO||' Дата выдачи паспорта должна быть обязательно указана');
      else
         cnt := round(months_between(rec_ok.PASS_DATE,rec_ok.birthday)/12);
        if (cnt<16)
        then
          err('Ошибка 05923 для отчетности ИИАС,Отдел Кадров:Таб.Номер='||rec_ok.TABNO||' Дата выдачи паспорта не верна');
        end if;
      end if;

      if (rec_ok.COD_STR_SITIZENT ='860')
      then
        select count(DISTR) into cnt from s_distr where DISTR= rec_ok.cod_distr_uvd;
        if (cnt=0) or (cnt is null) or (rec_ok.cod_distr_uvd is null)
        then
          err('Ошибка 05052 для отчетности ИИАС, Отдел Кадров: Не верный Код района, УВД которого был выдан паспорт Таб.Номер='||rec_ok.TABNO||' код.='||rec_ok.cod_distr_uvd);
        end if;
      else
        if rec_ok.COD_DISTR_PRIM is null
        then
          err('Ошибка 05924 для отчетности ИИАС, Отдел Кадров: Не указано Примечание к коду района, УВД которого был выдан паспорт Таб.Номер='||rec_ok.TABNO||' Cтрана гражд.='||rec_ok.COD_STR_SITIZENT);
        end if;
      end if;

      if (rec_ok.cod_str_birth <>'860') or (rec_ok.cod_str_birth is null)
      then
        if (rec_ok.COD_OBL_PRIM is null)
        then
          err('Ошибка 05925 для отчетности ИИАС, Отдел Кадров: Не указано примечание к <Место рождения Область> Таб.Номер='||rec_ok.TABNO||' Место рожд.страна.='||rec_ok.cod_str_birth);
        end if;
        if (rec_ok.COD_PLACE_BIRTH_PRIM is null)
        then
          err('Ошибка 05926 для отчетности ИИАС, Отдел Кадров: Не указано примечание к <Место рождения Район> Таб.Номер='||rec_ok.TABNO||' Место рожд.страна.='||rec_ok.cod_str_birth);
        end if;
      else
        if (rec_ok.REGION_ID is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров: Не указано <Место рождения Область> Таб.Номер='||rec_ok.TABNO||' Место рожд.страна.='||rec_ok.cod_str_birth);
        end if;
        if (rec_ok.DISTR is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров: Не указано <Место рождения Район> Таб.Номер='||rec_ok.TABNO||' Место рожд.страна.='||rec_ok.cod_str_birth);
        end if;
      end if;

      if (rec_ok.COD_STR_LIVE <>'860') or (rec_ok.COD_STR_LIVE is null)
      then
        if (rec_ok.COD_OBL_LIVE_PRIM is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров: Не указано примечание к <Место проживания Область> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_ok.COD_STR_LIVE);
        end if;
        if (rec_ok.COD_DISTR_LIVE_PRIM is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров: Не указано примечание к <Место проживания Район> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_ok.COD_STR_LIVE);
        end if;
      else
        if (rec_ok.COD_OBL_LIVE is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров: Не указано <Место проживания Область> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_ok.COD_STR_LIVE);
        end if;
        if (rec_ok.COD_DISTR_LIVE is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров: Не указано <Место проживания Район> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_ok.COD_STR_LIVE);
        end if;
      end if;

      if rec_ok.CHECK_KFS is null
      then
          err('Ошибка 05930 для отчетности ИИАС, Отдел Кадров: Не указано <Отметка о принадлежности к резерву руководящих кадров> Таб.Номер='||rec_ok.TABNO);
      end if;

      if rec_ok.BANK_SPEC is null
      then
          err('Ошибка 05931 для отчетности ИИАС, Отдел Кадров: Не указано <Отметка о наличие банковской специальности> Таб.Номер='||rec_ok.TABNO);
      end if;
      if (rec_ok.EDUCATION_TITLE_CODE is not null)
      then
        select to_number(s_id) into cnt from ss_ok_nci
        where nci_id=74 and ok_id= rec_ok.EDUCATION_TITLE_CODE and rownum<2;
        if (cnt<>3) and (cnt<>4) and (cnt<>5)
        then
          for rec_d2 in (select DEGREE_CODE  from ok_degree where personal_code=rec_ok.personal_code)
          loop
            select to_number(s_id) into cnt from ss_ok_nci
            where nci_id=75 and ok_id= rec_d2.DEGREE_CODE and rownum<2;
            if cnt<>1
            then
              err('Ошибка  для отчетности ИИАС,Отдел Кадров, ученая степень должна быть Степени Нет :Таб.Номер='||rec_ok.TABNO);
            end if;
          end loop;
          for rec_a2 in (select academic_CODE  from ok_academic where personal_code=rec_ok.personal_code)
          loop
            select to_number(s_id) into cnt from ss_ok_nci
            where nci_id=76 and ok_id= rec_a2.academic_CODE and rownum<2;
            if cnt<>1
            then
              err('Ошибка  для отчетности ИИАС,Отдел Кадров, ученое звание должно быть Звания Нет :Таб.Номер='||rec_ok.TABNO);
            end if;
          end loop;
        end if;

      end if;
    for rec_okrel in (select RELATION_DEATHDAY,relation_birthplace,relation_home_address,relation_office,
                   relation_post,RELATION_FAMILY,RELATION_NAME,RELATION_code,relation_birthday,
                   COD_STR_LIVE,COD_STR_BIRTH,
                   COD_OBL_LIVE_PRIM,COD_OBL_LIVE,COD_OBL_BIRTH_PRIM,COD_OBL_BIRTH,
                   COD_CITY_PRIM, COD_CITY,COD_CITY_BIRTH,
                   COD_CITY_BIRTH_PRIM,mm_death,dd_death from ok_relation 
           where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
     if (rec_okrel.RELATION_DEATHDAY is null)
     then
      if rec_okrel.relation_birthplace is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' не найдено место рождения родственника');
      end if;
      if rec_okrel.relation_home_address is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' не найдено место проживания родственника');
      end if;
      if rec_okrel.relation_office is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' не найдено место работы родственника напишите НЕ РАБОТАЕТ');
      end if;
      if rec_okrel.relation_post is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' не найдено должность родственника напишите НЕТ ДОЛЖНОСТИ');
      end if;
      if (rec_okrel.RELATION_FAMILY is null) or (rec_okrel.RELATION_NAME is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' Укажите Фамилию и Имя');
      end if;
      begin
        select ok_id into cnt from ss_ok_nci
        where nci_id=81 and s_id='02' and rownum<2; -- муж
      exception when others then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Справочник соответствия не заполнен Таб.Номер='||rec_ok.TABNO);
      end;
      if (rec_ok.gender_code=1) and (rec_okrel.relation_code=cnt)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' Пол Мужской- родственник не может быть Муж');
      end if;

      begin
        select ok_id into cnt from ss_ok_nci
        where nci_id=81 and s_id='01' and rownum<2; -- жена
      exception when others then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Справочник соответствия не заполнен Таб.Номер='||rec_ok.TABNO);
      end;
      if (rec_ok.gender_code=2) and (rec_okrel.relation_code=cnt)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' Пол Женский -родственник не может быть Жена');
      end if;

      if (rec_okrel.relation_birthday is null)
      then
        err('Ошибка 05919 для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' год рождения должен быть обязательно указан');
      else
          if ( (to_number(to_char(sysdate,'yyyy')))-(rec_okrel.relation_birthday )>120)
          then
            err('Ошибка 05919 для отчетности ИИАС,Отдел Кадров,родственники:Таб.Номер='||rec_ok.TABNO||' не правильный год рождения '||to_number(rec_okrel.relation_birthday));
          end if;
      end if;

      begin
        select s_id into cnt from ss_ok_nci
        where nci_id=81 and ok_id=rec_okrel.relation_code and rownum<2; -- жена
      exception when others then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники(279):Справочник соответствия не заполнен Таб.Номер='||rec_ok.TABNO);
      end;

      if cnt in ('03','04') -- данные о родителях для ЦБ должны быть старше сотрудника
      then
          if ( (to_number(to_char(rec_ok.birthday,'yyyy')))-(rec_okrel.relation_birthday )<0)
          then
            err('Ошибка 05933 для отчетности ИИАС,Отдел Кадров,родственники(286):Таб.Номер='||rec_ok.TABNO||' данные о родителях для ЦБ должны быть старше сотрудника. не правильный год рождения '||to_number(rec_okrel.relation_birthday));
          end if;
      end if;

      if cnt in ('09','10') -- данные о детях для ЦБ должны быть младше сотрудника
      then
          if ( (to_number(to_char(rec_ok.birthday,'yyyy')))-(rec_okrel.relation_birthday )>0)
          then
            err('Ошибка 05933 для отчетности ИИАС,Отдел Кадров,родственники(286):Таб.Номер='||rec_ok.TABNO||' данные о детях для ЦБ должны быть младше сотрудника. не правильный год рождения '||to_number(rec_okrel.relation_birthday));
          end if;
      end if;

      if (rec_okrel.COD_STR_LIVE <>'860') or (rec_okrel.COD_STR_LIVE is null)
      then
        if (rec_okrel.COD_OBL_LIVE_PRIM is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано примечание к <Место проживания Область> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_okrel.COD_STR_LIVE);
        end if;
        if (rec_okrel.COD_CITY_PRIM is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано примечание к <Место проживания Район> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_okrel.COD_STR_LIVE);
        end if;
      else
        if (rec_okrel.COD_OBL_LIVE is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано <Место проживания Область> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_okrel.COD_STR_LIVE);
        end if;
        if (rec_okrel.COD_CITY is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано <Место проживания Район> Таб.Номер='||rec_ok.TABNO||' Страна проживания='||rec_okrel.COD_STR_LIVE);
        end if;
      end if;

      if (rec_okrel.COD_STR_BIRTH <>'860') or (rec_okrel.COD_STR_BIRTH is null)
      then
        if (rec_okrel.COD_OBL_BIRTH_PRIM is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано примечание к <Место рождения Область> Таб.Номер='||rec_ok.TABNO||' Страна рождения='||rec_okrel.COD_STR_BIRTH);
        end if;
        if (rec_okrel.COD_CITY_BIRTH_PRIM is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано примечание к <Место рождения Район> Таб.Номер='||rec_ok.TABNO||' Страна рождения='||rec_okrel.COD_STR_BIRTH);
        end if;
      else
        if (rec_okrel.COD_OBL_BIRTH is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано <Место рождения Область> Таб.Номер='||rec_ok.TABNO||' Страна рождения='||rec_okrel.COD_STR_BIRTH);
        end if;
        if (rec_okrel.COD_CITY_BIRTH is null)
        then
          err('Ошибка для отчетности ИИАС, Отдел Кадров,родственники: Не указано <Место рождения Район> Таб.Номер='||rec_ok.TABNO||' Страна рождения='||rec_okrel.COD_STR_BIRTH);
        end if;
      end if;
     end if;

      if (rec_okrel.RELATION_DEATHDAY is not null)
      then
          if  (to_number(to_char(sysdate,'yyyy')))<(rec_okrel.RELATION_DEATHDAY )
          then
            err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники(344):Таб.Номер='||rec_ok.TABNO||' проверьте данные о смерти родственника '||to_number(rec_okrel.RELATION_DEATHDAY));
          end if;
          if  (rec_okrel.RELATION_BIRTHDAY)>(rec_okrel.RELATION_DEATHDAY )
          then
            err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники(348):Таб.Номер='||rec_ok.TABNO||' проверьте данные о рождении и смерти родственника '||to_number(rec_okrel.RELATION_DEATHDAY));
          end if;
      else
          if (rec_okrel.mm_death is not null) or (rec_okrel.dd_death is not null)
          then
            err('Ошибка для отчетности ИИАС,Отдел Кадров,родственники(344):Таб.Номер='||rec_ok.TABNO||' проверьте день,месяц- данные о смерти родственника ');
          end if;
      end if;

    end loop;

    for rec_okper in (select BRANCH,PERSONAL_CODE,IN_OFFICE_DATE,OUT_OFFICE_DATE,OFFICE_NAME,OFFICE_ADDRESS,ESTABLISHED_POST,MOTIVE_OUT,
           TYPE_PERIOD_CODE,ARTICLE_CODE,BASIS_NUM,BASIS_DATE,BASE_MOVE_CODE,ESTABLISHED_DEPARTMENT,PRIZ_SYSTEM,COD_BANK,COD_TYPE_PRN,COD_PR_OFF,
           PR_OFF,DATE_UTV_KM,NUMB_UTV_KM,DATE_PR_KVL,NUMB_PR_KVL,DATE_ATTEST,RESH_ATTEST,DOLJN_ID,NUM_PR_OFF,DATE_PR_OFF,POST_CODE,DEPARTMENT_CODE
         from ok_period where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
      if (rec_okper.in_office_date is null) or (rec_okper.in_office_date<rec_ok.birthday)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' неверна Дата начала работы в должности '||to_char(rec_okper.in_office_date));
      else
        cnt := round(months_between(rec_okper.in_office_date,rec_ok.birthday)/12);
        if cnt<13
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' Разница даты начала работы в должности и даты рождения сотрудника не должна быть меньше 13 лет '||to_char(rec_okper.in_office_date));
        end if;
      end if;

      if (rec_okper.out_office_date is not null)
      then
        if (rec_okper.out_office_date<rec_okper.in_office_date)
        or (rec_okper.out_office_date>sysdate)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' неверна Дата окончания работы в должности '||to_char(rec_okper.out_office_date));
        end if;
      end if;

      if (rec_okper.type_period_code is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите Тип стажа в строке Дата начала работы в должности '||to_char(rec_okper.in_office_date));
      end if;

      if (rec_okper.doljn_id is not null)
      then
        select count(dolj_id) into cnt from s_doljn where DOLJ_ID=rec_okper.doljn_id;
        if cnt=0
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' неверный код должности для ЦБ в строке Дата начала работы в должности '||to_char(rec_okper.in_office_date));
        end if;
      end if;

      if (rec_okper.established_post is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите должность в строке Дата начала работы в должности '||to_char(rec_okper.in_office_date));
      end if;

      if (rec_okper.cod_bank is not null)
      then
        select count(bank_id) into cnt from s_mfo where BANK_ID=rec_okper.cod_bank;
        if cnt=0
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' неверный код банка для ЦБ в строке Дата начала работы в должности '||to_char(rec_okper.in_office_date));
        end if;
      end if;

      if (rec_okper.basis_date is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите дату приказа в строке Дата начала работы в должности '||to_char(rec_okper.in_office_date));
      else
        if (rec_okper.basis_date> rec_okper.in_office_date)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' дата приказа больше Даты начала работы в должности '||to_char(rec_okper.in_office_date));
        end if;
      end if;

      if (rec_okper.out_office_date is not null)
      then
        if (rec_okper.NUM_PR_OFF is null)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите номер приказа основания прекращения работы в должности в строке Дата завершения работы '||to_char(rec_okper.out_office_date));
        end if;
        if (rec_okper.date_pr_off is null)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите дату приказа основания прекращения работы в должности в строке Дата завершения работы '||to_char(rec_okper.out_office_date));
        else
          if (rec_okper.date_pr_off> rec_okper.out_office_date)
          then
            err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' дата приказа основания прекращения работы в должности больше Даты завершения работы '||to_char(rec_okper.out_office_date));
          end if;
        end if;
        if (rec_okper.cod_pr_off is null)
        then
          if (rec_okper.PR_OFF is null)
          then
            err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите причину прекращения работы в должности в строке Дата завершения работы '||to_char(rec_okper.out_office_date));
          end if;
        else
          select count(prich_id) into cnt from s_prich where prich_id=rec_okper.cod_pr_off;
          if cnt=0
          then
            err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' код причины прекращения работы в должности не соответствует справочнику в строке Дата завершения работы '||to_char(rec_okper.out_office_date));
          end if;
        end if;
      end if;

      if (rec_okper.date_utv_km is not null) and (rec_okper.numb_utv_km is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите Номер постановления Кабинета Министров об утверждении в занимаемой должности в строке Дата завершения работы '||to_char(rec_okper.out_office_date));
      end if;

      if (rec_okper.date_pr_kvl is not null) and (rec_okper.numb_pr_kvl is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите Номер протокола Квалификационной комиссии Центрального банка о соответствии должности на которую выдвигается в строке Дата завершения работы '||to_char(rec_okper.out_office_date));
      end if;

      if (rec_okper.date_attest is not null) and (rec_okper.resh_attest is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе-Мехнат Фаолияти:Таб.Номер='||rec_ok.TABNO||' укажите Решение аттестационной комиссии в строке Дата завершения работы '||to_char(rec_okper.out_office_date));
      end if;

    end loop;

      begin
        select s_id into cnt_obraz from ss_ok_nci where nci_id=74
          and ok_id=rec_ok.EDUCATION_TITLE_CODE and rownum<2;
      exception when others then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,образование:Справочник соответствия не заполнен Таб.Номер='||rec_ok.TABNO);
      end;

    for rec_oked in (select BRANCH,PERSONAL_CODE,EDUCATION_CODE,BASIS_CODE,INSTITUTION_CODE,BEGIN_DATE,END_DATE,PROFESSION_PERSONAL,
       QUALIFICATION_CODE,DIPLOM_NUM,COD_VUZ_PRIM,CURS,FAKULTET,NOSTRA,NOSTRA_SERIES,NOSTRA_NUMBER,NOSTRA_DATE,
       DIPLOM_DATE,BEGIN_DATE_MM,BEGIN_DATE_DD,END_DATE_MM,END_DATE_DD,EDUCATION_END,EDUCATION_CITY,EDUCATION_COUNT_CODE,VID_EDUCATION_CODE
       from ok_education where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop

      begin
        select s_id into cnt_uchzav from ss_ok_nci where nci_id=80
          and ok_id=rec_oked.INSTITUTION_CODE and rownum<2;
      exception when others then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:Справочник соответствия не заполнен Таб.Номер='||rec_ok.TABNO||' код уч.заведения в ОК='||rec_oked.INSTITUTION_CODE);
      end;

      if (cnt_obraz in (1,6,7)) and (cnt_uchzav<>999)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:неверно указано образование-среднее для высших учебных заведений Таб.Номер='||rec_ok.TABNO);
      end if;

      if ((cnt_uchzav=202) or (cnt_uchzav=999)) and (rec_oked.COD_VUZ_PRIM is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:укажите примечание для учебного заведения Таб.Номер='||rec_ok.TABNO);
      end if;

      if (rec_oked.begin_date is null)
      and (((rec_oked.begin_date_mm is not null)) or (rec_oked.begin_date_dd is not null))
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:если не указан год поступления, день и месяц поступления нельзя вводить. Таб.Номер='||rec_ok.TABNO);
      end if;

      if (rec_oked.end_date is null)
      then
        if (rec_oked.CURS is null)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:если не указан год окончания, укажите курс. Таб.Номер='||rec_ok.TABNO);
        end if;
        if (((rec_oked.end_date_mm is not null)) or (rec_oked.end_date_dd is not null))
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:если не указан год окончания, день и месяц окончания нельзя вводить. Таб.Номер='||rec_ok.TABNO);
        end if;
      else
        if to_date( '01.01.'||to_char(rec_oked.end_date),'dd.mm.yyyy')>rec_oked.Diplom_Date
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:НЕВЕРНЫЙ год выдачи диплома. Таб.Номер='||rec_ok.TABNO);
        end if;
       BEGIN
        if (((rec_oked.end_date_mm is not null)) and (rec_oked.end_date_dd is not null))
        then
          if to_date( to_char(rec_oked.end_date_dd)||'.'||to_char(rec_oked.end_date_mm)||'.'||to_char(rec_oked.end_date),'dd.mm.yyyy')>rec_oked.Diplom_Date
          then
            err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:Неверная дата выдачи диплома. Таб.Номер='||rec_ok.TABNO);
          end if;
        end if;
       EXCEPTION WHEN OTHERS THEN NULL;
       END;
      end if;

      if (rec_oked.Diplom_Date is not null) and ( rec_oked.DIPLOM_NUM is null)
      then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:Если есть Дата выдачи диплома, то введите Номер диплома. Таб.Номер='||rec_ok.TABNO);
      end if;

      if (rec_oked.begin_date is not null)
      then
        if to_date( '01.01.'||to_char(rec_oked.begin_date),'dd.mm.yyyy')>sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:НЕВЕРНЫЙ год поступления. Таб.Номер='||rec_ok.TABNO);
        end if;
      end if;

      if (rec_oked.begin_date is not null)
      and (((rec_oked.begin_date_mm is not null)) and (rec_oked.begin_date_dd is not null))
      then
       BEGIN
        if to_date( to_char(rec_oked.begin_date_dd)||'.'||to_char(rec_oked.begin_date_mm)||'.'||to_char(rec_oked.begin_date),'dd.mm.yyyy')>sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:НЕВЕРНЫЙ год, день и месяц поступления. Таб.Номер='||rec_ok.TABNO);
        end if;
       EXCEPTION WHEN OTHERS THEN NULL;
       END;
      end if;

      if (rec_oked.begin_date is null)
      and (((rec_oked.begin_date_mm is not null)) or (rec_oked.begin_date_dd is not null))
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:если не указан год поступления, день и месяц поступления нельзя вводить. Таб.Номер='||rec_ok.TABNO);
      end if;

      if (cnt_obraz in (3,4,5)) and (rec_oked.profession_personal is null)
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:Укажите специальность Таб.Номер='||rec_ok.TABNO);
      end if;

      if (rec_oked.nostra='1') and (rec_oked.nostra_number is null or rec_oked.nostra_date is null)
      then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:Если есть Нострификация, то введите Дату и Номер. Таб.Номер='||rec_ok.TABNO);
      end if;

      if rec_oked.nostra_date > sysdate
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:Неверная дата Нострификации. Таб.Номер='||rec_ok.TABNO);
      end if;

      if (rec_oked.nostra_date-rec_ok.birthday) < 20*365
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Учебные заведения:Разница Даты нострификации и даты рождения сотрудника не должна быть меньше 20 и больше возраста сотрудника. Таб.Номер='||rec_ok.TABNO);
      end if;

    end loop;
      if rec_ok.NATIONALITY_CODE is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров:Таб.Номер='||rec_ok.TABNO||' не найдено национальность');
      end if;
    for rec_okpe in (select BASIS_NUM,BASIS_DATE from ok_period where branch=rec_ok.branch and personal_code=rec_ok.personal_code
       and OUT_OFFICE_DATE is null)
    loop
      if rec_okpe.BASIS_NUM is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе:Таб.Номер='||rec_ok.TABNO||' не найдено номер приказа');
      end if;
      if rec_okpe.BASIS_DATE is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,Сведения о работе:Таб.Номер='||rec_ok.TABNO||' не найдено дата приказа');
      end if;
    end loop;
    for rec_okaw in (select Award_info,Award_date,Award_date_dd,Award_date_mm from ok_award where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
      if rec_okaw.Award_info is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,награды:Таб.Номер='||rec_ok.TABNO||' не найдено сведения о награде');
      end if;
      if rec_okaw.Award_date is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,награды:Таб.Номер='||rec_ok.TABNO||' не найдено год награждения');
      end if;

     BEGIN
      if (rec_okaw.Award_date_dd is not null)
      and (rec_okaw.Award_date_mm is not null)
      then
       BEGIN
        if to_date(to_char(rec_okaw.Award_date_dd)||'.'||to_char(rec_okaw.Award_date_mm)||'.'||to_char(rec_okaw.Award_date),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,награды:Таб.Номер='||rec_ok.TABNO||' неправильный год награждения');
        end if;
        if to_date(to_char(rec_okaw.Award_date_dd)||'.'||to_char(rec_okaw.Award_date_mm)||'.'||to_char(rec_okaw.Award_date),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,награды:Таб.Номер='||rec_ok.TABNO||' Разница Даты награждения и даты рождения сотрудника  должна быть больше 18');
        end if;
       EXCEPTION WHEN OTHERS THEN NULL;
       END;

      else
        if to_date('01.01.'||to_char(rec_okaw.Award_date),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,награды:Таб.Номер='||rec_ok.TABNO||' неправильный год награждения');
        end if;
        if to_date('01.01.'||to_char(rec_okaw.Award_date),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,награды:Таб.Номер='||rec_ok.TABNO||' Разница Даты награждения и даты рождения сотрудника  должна быть больше 18');
        end if;
      end if;
     EXCEPTION WHEN OTHERS THEN NULL;
     END;
    end loop;
    for rec_okel in (select BRANCH,PERSONAL_CODE,ELECTION_ADDRESS,ELECTION_NAME,
       ELECTION_POST,ELECTION_DATE_BEGIN,ELECTION_DATE_END,ELECTION_CODE,
       ELECTION_DATE_BEGIN_MM,ELECTION_DATE_BEGIN_DD,ELECTION_DATE_END_MM,
       ELECTION_DATE_END_DD from ok_election
          where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
      if rec_okel.election_CODE is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,избрание:Таб.Номер='||rec_ok.TABNO||' не найдено сведения об избрании');
      end if;
      if rec_okel.election_date_begin is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,избрание:Таб.Номер='||rec_ok.TABNO||' не найдено год избрания');
      end if;

     BEGIN
      if (rec_okel.election_date_begin_dd is not null)
      and (rec_okel.election_date_begin_mm is not null)
      then
       BEGIN
        if to_date(to_char(rec_okel.election_date_begin_dd)||'.'||to_char(rec_okel.election_date_begin_mm)||'.'||to_char(rec_okel.election_date_begin),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,избрание:Таб.Номер='||rec_ok.TABNO||' неправильный год избрания');
        end if;
        if to_date(to_char(rec_okel.election_date_begin_dd)||'.'||to_char(rec_okel.election_date_begin_mm)||'.'||to_char(rec_okel.election_date_begin),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,избрание:Таб.Номер='||rec_ok.TABNO||' Разница Даты избрания и даты рождения сотрудника  должна быть больше 18');
        end if;
       EXCEPTION WHEN OTHERS THEN NULL;
       END;

      else
        if to_date('01.01.'||to_char(rec_okel.election_date_begin),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,избрание:Таб.Номер='||rec_ok.TABNO||' неправильный год избрание');
        end if;
        if to_date('01.01.'||to_char(rec_okel.election_date_begin),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,избрание:Таб.Номер='||rec_ok.TABNO||' Разница Даты избрание и даты рождения сотрудника  должна быть больше 18');
        end if;
      end if;
     EXCEPTION WHEN OTHERS THEN NULL;
     END;

    end loop;
    for rec_okri in (select BRANCH,PERSONAL_CODE,RISE_DATE_YEAR,RISE_INFO,RISE_DATE_MM,RISE_DATE_DD from ok_rise
           where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
      if rec_okri.rise_date_year is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,квалификация:Таб.Номер='||rec_ok.TABNO||' не найден год квалификации');
      end if;
      if rec_okri.rise_date_mm is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,квалификация:Таб.Номер='||rec_ok.TABNO||' не найден месяц квалификации');
      end if;
      if rec_okri.rise_date_dd is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,квалификация:Таб.Номер='||rec_ok.TABNO||' не найден день квалификации');
      end if;

     BEGIN
      if (rec_okri.rise_date_dd is not null)
      and (rec_okri.rise_date_mm is not null)
      then
       BEGIN
        if to_date(to_char(rec_okri.rise_date_dd)||'.'||to_char(rec_okri.rise_date_mm)||'.'||to_char(rec_okri.rise_date_year),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,квалификации:Таб.Номер='||rec_ok.TABNO||' неправильный год квалификации');
        end if;
        if to_date(to_char(rec_okri.rise_date_dd)||'.'||to_char(rec_okri.rise_date_mm)||'.'||to_char(rec_okri.rise_date_year ),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,квалификации:Таб.Номер='||rec_ok.TABNO||' Разница Даты квалификации и даты рождения сотрудника  должна быть больше 18');
        end if;
       EXCEPTION WHEN OTHERS THEN NULL;
       END;
      else
        if to_date('01.01.'||to_char(rec_okri.rise_date_year),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,квалификации:Таб.Номер='||rec_ok.TABNO||' неправильный год квалификации');
        end if;
        if to_date('01.01.'||to_char(rec_okri.rise_date_year),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,квалификации:Таб.Номер='||rec_ok.TABNO||' Разница Даты квалификации и даты рождения сотрудника  должна быть больше 18');
        end if;
      end if;
     EXCEPTION WHEN OTHERS THEN NULL;
     END;

    end loop;
    for rec_oklang in (select LANGUAGE_CODE,COD_LANG_PRIM from ok_LANGUAGE where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
      if (rec_oklang.LANGUAGE_CODE is null)
      and (rec_oklang.COD_LANG_PRIM is null)
      then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,ин.яз:Таб.Номер='||rec_ok.TABNO||' Если не указан код иностранного языка из справочника, то обязательно заполняется реквизит Примечание для кода иностранного языка');
      end if;
    end loop;
    for rec_okvoy in (select BRANCH,PERSONAL_CODE,VOYAGE_DATE,VOYAGE_LAND,
        VOYAGE_INFO,VOYAGE_STR,DATA_IN,VOYAGE_DATE_MM,
        VOYAGE_DATE_DD,DATA_IN_MM,DATA_IN_DD from ok_voyage
          where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
      if (rec_okvoy.VOYAGE_STR ='860')
      then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Зарубежные поездки:Таб.Номер='||rec_ok.TABNO||' Реквизит Пребывание за границей страна не должен быть равен значению Узбекистан');
      end if;
      if (rec_okvoy.VOYAGE_DATE is null)
      then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Зарубежные поездки:Таб.Номер='||rec_ok.TABNO||' укажите год даты выезда');
      end if;
      if (rec_okvoy.VOYAGE_DATE is null)
      then
        if (rec_okvoy.VOYAGE_DATE_MM is not null) or (rec_okvoy.VOYAGE_DATE_DD is not null)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Зарубежные поездки:Таб.Номер='||rec_ok.TABNO||' Если Год выезда за границу не указан, то день и месяц выезда не указывается');
        end if;
        if (rec_okvoy.DATA_IN is not null)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Зарубежные поездки:Таб.Номер='||rec_ok.TABNO||' Если Дата выезда за границу не указан, то Дата возвращения не указывается');
        end if;
      end if;
      if (rec_okvoy.DATA_IN is null)
      then
        if (rec_okvoy.DATA_IN_MM is not null) or (rec_okvoy.DATA_IN_DD is not null)
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,Зарубежные поездки:Таб.Номер='||rec_ok.TABNO||' Если год даты возвращения из-за границы не указан, то число и месяц даты возвращения не должны указываться');
        end if;
      end if;

     BEGIN
      if (rec_okvoy.VOYAGE_DATE_dd is not null)
      and (rec_okvoy.VOYAGE_DATE_mm is not null)
      then
       BEGIN
        if to_date(to_char(rec_okvoy.VOYAGE_DATE_dd)||'.'||to_char(rec_okvoy.VOYAGE_DATE_mm)||'.'||to_char(rec_okvoy.VOYAGE_DATE),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' неправильный год зарубежной поездки');
        end if;
        if to_date(to_char(rec_okvoy.VOYAGE_DATE_dd)||'.'||to_char(rec_okvoy.VOYAGE_DATE_mm)||'.'||to_char(rec_okvoy.VOYAGE_DATE ),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' Разница Даты зарубежной поездки и даты рождения сотрудника  должна быть больше 18');
        end if;
       EXCEPTION WHEN OTHERS THEN NULL;
       END;

      else
        if to_date('01.01.'||to_char(rec_okvoy.VOYAGE_DATE),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' неправильный год зарубежной поездки');
        end if;
        if to_date('01.01.'||to_char(rec_okvoy.VOYAGE_DATE),'dd.mm.yyyy') - rec_ok.birthday< 18*365
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' Разница Даты зарубежной поездки и даты рождения сотрудника  должна быть больше 18');
        end if;
      end if;
     EXCEPTION WHEN OTHERS THEN NULL;
     END;

      if ((rec_okvoy.DATA_IN_dd is not null)
      or (rec_okvoy.DATA_IN_mm is not null))
      and ((rec_okvoy.VOYAGE_DATE_dd is null)
      or (rec_okvoy.VOYAGE_DATE_mm is null))
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' если указан день и месяц возвращения из зарубежной поездки то укажите день и месяц поездки');
      end if;

     BEGIN
      if (rec_okvoy.DATA_IN_dd is not null)
      and (rec_okvoy.DATA_IN_mm is not null)
      and (rec_okvoy.DATA_IN is not null)
      and  (rec_okvoy.VOYAGE_DATE_dd is not null)
      and (rec_okvoy.VOYAGE_DATE_mm is not null)
      and (rec_okvoy.VOYAGE_DATE is not null)
      then
        if to_date(to_char(rec_okvoy.DATA_IN_dd)||'.'||to_char(rec_okvoy.DATA_IN_mm)||'.'||to_char(rec_okvoy.DATA_IN),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' неправильный год возвращения из зарубежной поездки');
        end if;
        if to_date(to_char(rec_okvoy.DATA_IN_dd)||'.'||to_char(rec_okvoy.DATA_IN_mm)||'.'||to_char(rec_okvoy.DATA_IN ),'dd.mm.yyyy') -
           to_date(to_char(rec_okvoy.VOYAGE_DATE_dd)||'.'||to_char(rec_okvoy.VOYAGE_DATE_mm)||'.'||to_char(rec_okvoy.VOYAGE_DATE),'dd.mm.yyyy') < 0
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' Неверная Даты возвращения из зарубежной поездки ');
        end if;
      else
        if to_date('01.01.'||to_char(rec_okvoy.DATA_IN),'dd.mm.yyyy') >sysdate
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' неправильный год возвращения из зарубежной поездки');
        end if;
        if rec_okvoy.DATA_IN < rec_okvoy.VOYAGE_DATE
        then
          err('Ошибка для отчетности ИИАС,Отдел Кадров,зарубежной поездки:Таб.Номер='||rec_ok.TABNO||' Разница Даты возвращения из зарубежной поездки и даты рождения сотрудника  должна быть больше 18');
        end if;
      end if;
     EXCEPTION WHEN OTHERS THEN NULL;
     END;
    end loop;
    for rec_okpt in (select party_CODE,party_date from ok_party where branch=rec_ok.branch and personal_code=rec_ok.personal_code)
    loop
      if rec_okpt.party_CODE is null
      then
        err('Ошибка для отчетности ИИАС,Отдел Кадров,партия:Таб.Номер='||rec_ok.TABNO||' не найдено сведения о партии');
      else
        select count(s_id) into cnt from ss_ok_nci
        where nci_id=73 and s_id='01' and ok_id= rec_okpt.party_code;
        if (cnt<1) and (rec_okpt.party_date is null)
        then
          err('Ошибка 05928 для отчетности ИИАС,Отдел Кадров,партия:Таб.Номер='||rec_ok.TABNO||' не найдено год вступления');
        end if;
        if (cnt<1) and (rec_okpt.party_date is not null)
        then
          if ((rec_okpt.party_date- to_number(to_char(rec_ok.birthday,'yyyy')) )<18)
          or (rec_okpt.party_date> to_number(to_char(sysdate,'yyyy')) )
          then
            err('Ошибка 05929 для отчетности ИИАС,Отдел Кадров,партия:Таб.Номер='||rec_ok.TABNO||' не правильный год вступления '||to_number(rec_okpt.party_date));
          end if;
        end if;
      end if;
    end loop;
  end loop;
end;
